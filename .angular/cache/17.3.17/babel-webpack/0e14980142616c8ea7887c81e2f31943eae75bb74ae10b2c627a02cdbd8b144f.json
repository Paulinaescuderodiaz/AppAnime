{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Equipo/Downloads/AppAnime/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/auth.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction ProfilePage_div_10_ion_button_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-button\", 27);\n    i0.ɵɵlistener(\"click\", function ProfilePage_div_10_ion_button_25_Template_ion_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.toggleEdit());\n    });\n    i0.ɵɵelement(1, \"ion-icon\", 28);\n    i0.ɵɵtext(2, \" Editar Perfil \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfilePage_div_10_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"ion-button\", 30);\n    i0.ɵɵlistener(\"click\", function ProfilePage_div_10_div_26_Template_ion_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.saveProfile());\n    });\n    i0.ɵɵelement(2, \"ion-icon\", 31);\n    i0.ɵɵtext(3, \" Guardar \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-button\", 32);\n    i0.ɵɵlistener(\"click\", function ProfilePage_div_10_div_26_Template_ion_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.toggleEdit());\n    });\n    i0.ɵɵelement(5, \"ion-icon\", 33);\n    i0.ɵɵtext(6, \" Cancelar \");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProfilePage_div_10_ion_card_27_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-card\", 14)(1, \"ion-card-header\")(2, \"ion-card-title\");\n    i0.ɵɵelement(3, \"ion-icon\", 34);\n    i0.ɵɵtext(4, \" Seguridad \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"ion-card-content\")(6, \"ion-button\", 32);\n    i0.ɵɵlistener(\"click\", function ProfilePage_div_10_ion_card_27_Template_ion_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.changePassword());\n    });\n    i0.ɵɵelement(7, \"ion-icon\", 35);\n    i0.ɵɵtext(8, \" Cambiar Contrase\\u00F1a \");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction ProfilePage_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"div\", 10)(2, \"div\", 11);\n    i0.ɵɵelement(3, \"ion-icon\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"h2\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"ion-badge\", 13);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"ion-card\", 14)(11, \"ion-card-header\")(12, \"ion-card-title\");\n    i0.ɵɵelement(13, \"ion-icon\", 15);\n    i0.ɵɵtext(14, \" Informaci\\u00F3n Personal \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"ion-card-content\")(16, \"ion-item\", 16)(17, \"ion-label\", 17);\n    i0.ɵɵtext(18, \"Nombre Completo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"ion-input\", 18);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfilePage_div_10_Template_ion_input_ngModelChange_19_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.fullName, $event) || (ctx_r1.fullName = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"ion-item\", 16)(21, \"ion-label\", 17);\n    i0.ɵɵtext(22, \"Correo Electr\\u00F3nico\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"ion-input\", 19);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProfilePage_div_10_Template_ion_input_ngModelChange_23_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.email, $event) || (ctx_r1.email = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(24, \"div\", 20);\n    i0.ɵɵtemplate(25, ProfilePage_div_10_ion_button_25_Template, 3, 0, \"ion-button\", 21)(26, ProfilePage_div_10_div_26_Template, 7, 0, \"div\", 22);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(27, ProfilePage_div_10_ion_card_27_Template, 9, 0, \"ion-card\", 23);\n    i0.ɵɵelementStart(28, \"ion-card\", 24)(29, \"ion-card-content\")(30, \"ion-button\", 25);\n    i0.ɵɵlistener(\"click\", function ProfilePage_div_10_Template_ion_button_click_30_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.logout());\n    });\n    i0.ɵɵelement(31, \"ion-icon\", 26);\n    i0.ɵɵtext(32, \" Cerrar Sesi\\u00F3n \");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r1.currentUser.fullName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.currentUser.email);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"color\", ctx_r1.currentUser.authProvider === \"Google\" ? \"danger\" : \"primary\");\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.currentUser.authProvider === \"Google\" ? \"Google\" : \"Local\", \" \");\n    i0.ɵɵadvance(10);\n    i0.ɵɵclassProp(\"editing\", ctx_r1.isEditing);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.fullName);\n    i0.ɵɵproperty(\"readonly\", !ctx_r1.isEditing);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.isEditing);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isEditing);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.currentUser.authProvider !== \"Google\");\n  }\n}\nexport let ProfilePage = /*#__PURE__*/(() => {\n  class ProfilePage {\n    authService;\n    router;\n    alertController;\n    loadingController;\n    currentUser = null;\n    fullName = '';\n    email = '';\n    isEditing = false;\n    constructor(authService, router, alertController, loadingController) {\n      this.authService = authService;\n      this.router = router;\n      this.alertController = alertController;\n      this.loadingController = loadingController;\n    }\n    ngOnInit() {\n      this.loadUserData();\n    }\n    ionViewWillEnter() {\n      this.loadUserData();\n    }\n    loadUserData() {\n      this.authService.getCurrentUser().subscribe({\n        next: user => {\n          this.currentUser = user;\n          if (user) {\n            this.fullName = user.fullName;\n            this.email = user.email;\n          }\n        }\n      });\n    }\n    toggleEdit() {\n      this.isEditing = !this.isEditing;\n      if (!this.isEditing) {\n        this.loadUserData();\n      }\n    }\n    saveProfile() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        if (!_this.fullName.trim()) {\n          _this.showAlert('Error', 'El nombre no puede estar vacío');\n          return;\n        }\n        const loading = yield _this.loadingController.create({\n          message: 'Guardando cambios...'\n        });\n        yield loading.present();\n        try {\n          const result = yield _this.authService.updateProfile({\n            fullName: _this.fullName\n          });\n          yield loading.dismiss();\n          if (result.success) {\n            _this.isEditing = false;\n            _this.showAlert('¡Listo!', 'Perfil actualizado correctamente');\n          } else {\n            _this.showAlert('Error', result.message || 'No se pudo actualizar el perfil');\n          }\n        } catch (error) {\n          yield loading.dismiss();\n          _this.showAlert('Error', 'No se pudo actualizar el perfil');\n        }\n      })();\n    }\n    changePassword() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const alert = yield _this2.alertController.create({\n          header: 'Cambiar Contraseña',\n          inputs: [{\n            name: 'currentPassword',\n            type: 'password',\n            placeholder: 'Contraseña actual'\n          }, {\n            name: 'newPassword',\n            type: 'password',\n            placeholder: 'Nueva contraseña'\n          }, {\n            name: 'confirmPassword',\n            type: 'password',\n            placeholder: 'Confirmar nueva contraseña'\n          }],\n          buttons: [{\n            text: 'Cancelar',\n            role: 'cancel'\n          }, {\n            text: 'Cambiar',\n            handler: data => {\n              _this2.processPasswordChange(data);\n            }\n          }]\n        });\n        yield alert.present();\n      })();\n    }\n    processPasswordChange(data) {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        if (!data.currentPassword || !data.newPassword || !data.confirmPassword) {\n          _this3.showAlert('Error', 'Completa todos los campos');\n          return;\n        }\n        if (data.newPassword !== data.confirmPassword) {\n          _this3.showAlert('Error', 'Las contraseñas no coinciden');\n          return;\n        }\n        if (data.newPassword.length < 6) {\n          _this3.showAlert('Error', 'La nueva contraseña debe tener al menos 6 caracteres');\n          return;\n        }\n        const loading = yield _this3.loadingController.create({\n          message: 'Cambiando contraseña...'\n        });\n        yield loading.present();\n        try {\n          const result = yield _this3.authService.changePassword(data.currentPassword, data.newPassword);\n          yield loading.dismiss();\n          if (result.success) {\n            _this3.showAlert('¡Listo!', 'Contraseña actualizada correctamente');\n          } else {\n            _this3.showAlert('Error', result.message || 'No se pudo cambiar la contraseña');\n          }\n        } catch (error) {\n          yield loading.dismiss();\n          _this3.showAlert('Error', error?.message || 'No se pudo cambiar la contraseña');\n        }\n      })();\n    }\n    logout() {\n      var _this4 = this;\n      return _asyncToGenerator(function* () {\n        const alert = yield _this4.alertController.create({\n          header: 'Cerrar Sesión',\n          message: '¿Estás seguro que deseas cerrar sesión?',\n          buttons: [{\n            text: 'Cancelar',\n            role: 'cancel'\n          }, {\n            text: 'Sí, cerrar sesión',\n            handler: () => {\n              _this4.confirmLogout();\n            }\n          }]\n        });\n        yield alert.present();\n      })();\n    }\n    confirmLogout() {\n      var _this5 = this;\n      return _asyncToGenerator(function* () {\n        const loading = yield _this5.loadingController.create({\n          message: 'Cerrando sesión...'\n        });\n        yield loading.present();\n        try {\n          yield _this5.authService.logout();\n          yield loading.dismiss();\n          _this5.router.navigate(['/login'], {\n            replaceUrl: true\n          });\n        } catch (error) {\n          yield loading.dismiss();\n          _this5.showAlert('Error', 'No se pudo cerrar sesión');\n        }\n      })();\n    }\n    goBack() {\n      this.router.navigate(['/home']);\n    }\n    showAlert(header, message) {\n      var _this6 = this;\n      return _asyncToGenerator(function* () {\n        const alert = yield _this6.alertController.create({\n          header,\n          message,\n          buttons: ['OK']\n        });\n        yield alert.present();\n      })();\n    }\n    static ɵfac = function ProfilePage_Factory(t) {\n      return new (t || ProfilePage)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.AlertController), i0.ɵɵdirectiveInject(i3.LoadingController));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ProfilePage,\n      selectors: [[\"app-profile\"]],\n      decls: 11,\n      vars: 3,\n      consts: [[3, \"translucent\"], [\"color\", \"dark\"], [\"slot\", \"start\"], [\"defaultHref\", \"/home\", \"text\", \"\"], [\"slot\", \"end\"], [\"color\", \"danger\", 3, \"click\"], [\"name\", \"log-out-outline\"], [1, \"profile-content\", 3, \"fullscreen\"], [\"class\", \"profile-container\", 4, \"ngIf\"], [1, \"profile-container\"], [1, \"profile-header\"], [1, \"avatar-circle\"], [\"name\", \"person\"], [3, \"color\"], [1, \"profile-card\"], [\"name\", \"person-circle-outline\"], [\"lines\", \"none\", 1, \"profile-item\"], [\"position\", \"stacked\"], [3, \"ngModelChange\", \"ngModel\", \"readonly\"], [\"readonly\", \"\", 1, \"readonly-input\", 3, \"ngModelChange\", \"ngModel\"], [1, \"button-group\"], [\"expand\", \"block\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"edit-buttons\", 4, \"ngIf\"], [\"class\", \"profile-card\", 4, \"ngIf\"], [1, \"profile-card\", \"logout-card\"], [\"expand\", \"block\", \"color\", \"danger\", \"fill\", \"outline\", 3, \"click\"], [\"name\", \"log-out-outline\", \"slot\", \"start\"], [\"expand\", \"block\", 3, \"click\"], [\"name\", \"create-outline\", \"slot\", \"start\"], [1, \"edit-buttons\"], [\"expand\", \"block\", \"color\", \"success\", 3, \"click\"], [\"name\", \"checkmark-outline\", \"slot\", \"start\"], [\"expand\", \"block\", \"fill\", \"outline\", 3, \"click\"], [\"name\", \"close-outline\", \"slot\", \"start\"], [\"name\", \"lock-closed-outline\"], [\"name\", \"key-outline\", \"slot\", \"start\"]],\n      template: function ProfilePage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\", 1)(2, \"ion-buttons\", 2);\n          i0.ɵɵelement(3, \"ion-back-button\", 3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"ion-title\");\n          i0.ɵɵtext(5, \"Perfil\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"ion-buttons\", 4)(7, \"ion-button\", 5);\n          i0.ɵɵlistener(\"click\", function ProfilePage_Template_ion_button_click_7_listener() {\n            return ctx.logout();\n          });\n          i0.ɵɵelement(8, \"ion-icon\", 6);\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(9, \"ion-content\", 7);\n          i0.ɵɵtemplate(10, ProfilePage_div_10_Template, 33, 12, \"div\", 8);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"translucent\", true);\n          i0.ɵɵadvance(9);\n          i0.ɵɵproperty(\"fullscreen\", true);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.currentUser);\n        }\n      },\n      dependencies: [i4.NgIf, i5.NgControlStatus, i5.NgModel, i3.IonBadge, i3.IonButton, i3.IonButtons, i3.IonCard, i3.IonCardContent, i3.IonCardHeader, i3.IonCardTitle, i3.IonContent, i3.IonHeader, i3.IonIcon, i3.IonInput, i3.IonItem, i3.IonLabel, i3.IonTitle, i3.IonToolbar, i3.TextValueAccessor, i3.IonBackButton],\n      styles: [\".profile-content[_ngcontent-%COMP%]{--background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%)}.profile-container[_ngcontent-%COMP%]{padding:20px}.profile-header[_ngcontent-%COMP%]{text-align:center;padding:30px 20px;margin-bottom:20px}.profile-header[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;background:linear-gradient(135deg,#e94560,#d63447);display:flex;align-items:center;justify-content:center;margin:0 auto 20px;box-shadow:0 4px 20px #e9456066}.profile-header[_ngcontent-%COMP%]   .avatar-circle[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:50px;color:#fff}.profile-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;font-size:24px;font-weight:700;margin:10px 0}.profile-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#ffffffb3;font-size:14px;margin:5px 0 15px}.profile-card[_ngcontent-%COMP%]{background:#ffffff0d;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border-radius:16px;margin-bottom:16px;box-shadow:0 4px 20px #0000004d}.profile-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:#fff;font-size:18px;font-weight:600;display:flex;align-items:center;gap:10px}.profile-card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#e94560;font-size:24px}.profile-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .profile-item[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .05);--border-radius: 12px;margin-bottom:16px;border-radius:12px}.profile-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .profile-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:#ffffffb3;font-size:13px;margin-bottom:5px}.profile-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .profile-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--color: #ffffff;--padding-start: 12px;--padding-end: 12px;font-size:16px}.profile-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .profile-item[_ngcontent-%COMP%]   ion-input.editing[_ngcontent-%COMP%]{--background: rgba(233, 69, 96, .1)}.profile-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .profile-item[_ngcontent-%COMP%]   ion-input.readonly-input[_ngcontent-%COMP%]{opacity:.6}.profile-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{margin-top:20px}.profile-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.profile-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 12px;height:48px;font-weight:600;text-transform:none}.logout-card[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-color: #e94560;--color: #e94560}.logout-card[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]:hover{--background: rgba(233, 69, 96, .1)}\"]\n    });\n  }\n  return ProfilePage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}